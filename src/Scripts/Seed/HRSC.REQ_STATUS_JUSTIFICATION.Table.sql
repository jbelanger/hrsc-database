
--MERGE generated by 'sp_generate_merge' stored procedure
--Originally by Vyas (http://vyaskn.tripod.com/code): sp_generate_inserts (build 22)
--Adapted for SQL Server 2008+ by Daniel Nolan (https://twitter.com/dnlnln)

SET NOCOUNT ON

SET IDENTITY_INSERT [HRSC].[REQ_STATUS_JUSTIFICATION] ON

DECLARE @mergeOutput462624691 TABLE ( [DMLAction] VARCHAR(6) );
MERGE INTO [HRSC].[REQ_STATUS_JUSTIFICATION] AS [Target]
USING (VALUES
  (11,34,38,NULL,'2013-04-05T12:26:49.430',N'Lam, Jennifer [NC]','2013-04-05T12:21:23.097',N'Lam, Jennifer [NC]','2013-04-05T12:26:49.430')
 ,(12,35,38,NULL,'2013-04-05T12:26:39.780',N'Lam, Jennifer [NC]','2013-04-05T12:22:27.790',N'Lam, Jennifer [NC]','2013-04-05T12:26:39.780')
 ,(13,35,38,NULL,'2015-08-20T16:10:59.870',N'Lam, Jennifer [NC]','2013-04-05T12:26:39.787',N'Robichaud, Martin M [NC]','2015-08-20T16:10:59.870')
 ,(14,34,38,NULL,'2015-08-20T16:06:58.607',N'Lam, Jennifer [NC]','2013-04-05T12:26:49.430',N'Robichaud, Martin M [NC]','2015-08-20T16:06:58.607')
 ,(15,36,38,NULL,NULL,N'Lam, Jennifer [NC]','2013-04-05T12:36:21.777',NULL,NULL)
 ,(16,37,38,NULL,NULL,N'Lam, Jennifer [NC]','2013-04-05T12:37:23.013',NULL,NULL)
 ,(17,38,38,NULL,'2013-04-05T12:44:22.760',N'Lam, Jennifer [NC]','2013-04-05T12:38:17.293',N'Lam, Jennifer [NC]','2013-04-05T12:44:22.760')
 ,(18,39,38,NULL,'2013-04-05T12:39:23.707',N'Lam, Jennifer [NC]','2013-04-05T12:39:00.970',N'Lam, Jennifer [NC]','2013-04-05T12:39:23.707')
 ,(19,39,38,NULL,NULL,N'Lam, Jennifer [NC]','2013-04-05T12:39:23.710',NULL,NULL)
 ,(20,40,38,NULL,NULL,N'Lam, Jennifer [NC]','2013-04-05T12:40:25.070',NULL,NULL)
 ,(21,41,38,NULL,NULL,N'Lam, Jennifer [NC]','2013-04-05T12:41:05.003',NULL,NULL)
 ,(22,42,38,NULL,'2013-04-18T11:30:16.057',N'Lam, Jennifer [NC]','2013-04-05T12:42:17.513',N'Lafortune, Jean-Luc [NC]','2013-04-18T11:30:16.057')
 ,(23,43,38,NULL,'2013-04-15T16:01:11.267',N'Lam, Jennifer [NC]','2013-04-05T12:42:53.403',N'Robichaud, Martin [NC]','2013-04-15T16:01:11.267')
 ,(24,44,38,NULL,'2013-06-25T10:46:33.027',N'Lam, Jennifer [NC]','2013-04-05T12:43:50.583',N'Tremblay-Noel, Mathieu [NC]','2013-06-25T10:46:33.027')
 ,(25,38,38,NULL,'2013-06-14T08:29:14.930',N'Lam, Jennifer [NC]','2013-04-05T12:44:22.760',N'Ineza, Raissa [NC]','2013-06-14T08:29:14.930')
 ,(26,45,28,NULL,NULL,N'Lam, Jennifer [NC]','2013-04-05T12:47:14.737',NULL,NULL)
 ,(27,46,28,NULL,'2015-08-20T16:23:46.320',N'Lam, Jennifer [NC]','2013-04-05T12:47:48.670',N'Robichaud, Martin M [NC]','2015-08-20T16:23:46.320')
 ,(28,47,39,NULL,NULL,N'Lam, Jennifer [NC]','2013-04-05T12:48:37.210',NULL,NULL)
 ,(30,49,39,NULL,'2015-12-14T10:55:18.953',N'Lam, Jennifer [NC]','2013-04-05T12:50:08.860',N'Robichaud, Martin M [NC]','2015-12-14T10:55:18.953')
 ,(31,43,38,NULL,'2015-08-20T16:20:08.770',N'Robichaud, Martin [NC]','2013-04-15T16:01:11.277',N'Robichaud, Martin M [NC]','2015-08-20T16:20:08.770')
 ,(32,42,38,NULL,'2013-04-18T11:32:00.463',N'Lafortune, Jean-Luc [NC]','2013-04-18T11:30:16.160',N'Lafortune, Jean-Luc [NC]','2013-04-18T11:32:00.463')
 ,(33,42,38,NULL,'2013-04-18T11:32:07.380',N'Lafortune, Jean-Luc [NC]','2013-04-18T11:32:00.470',N'Lafortune, Jean-Luc [NC]','2013-04-18T11:32:07.380')
 ,(34,42,38,NULL,'2013-08-29T10:39:42.797',N'Lafortune, Jean-Luc [NC]','2013-04-18T11:32:07.383',N'Tremblay-Noel, Mathieu [NC]','2013-08-29T10:39:42.797')
 ,(36,38,38,NULL,'2015-08-20T16:15:17.987',N'Ineza, Raissa [NC]','2013-06-14T08:29:14.940',N'Robichaud, Martin M [NC]','2015-08-20T16:15:17.987')
 ,(37,50,38,NULL,'2015-08-20T16:18:57.950',N'Ineza, Raissa [NC]','2013-06-19T11:20:09',N'Robichaud, Martin M [NC]','2015-08-20T16:18:57.950')
 ,(38,44,38,NULL,'2020-03-20T13:54:27.310',N'Tremblay-Noel, Mathieu [NC]','2013-06-25T10:46:33.027',N'Robichaud, Martin M [NC]','2020-03-20T13:54:27.310')
 ,(39,42,38,NULL,NULL,N'Tremblay-Noel, Mathieu [NC]','2013-08-29T10:39:42.800',NULL,NULL)
 ,(40,34,38,NULL,NULL,N'Robichaud, Martin M [NC]','2015-08-20T16:06:58.610',NULL,NULL)
 ,(41,35,38,NULL,NULL,N'Robichaud, Martin M [NC]','2015-08-20T16:10:59.870',NULL,NULL)
 ,(42,38,38,NULL,NULL,N'Robichaud, Martin M [NC]','2015-08-20T16:15:17.987',NULL,NULL)
 ,(43,50,38,NULL,'2018-08-10T12:17:37.540',N'Robichaud, Martin M [NC]','2015-08-20T16:18:57.950',N'Dalebozik, Michael MW [NC]','2018-08-10T12:17:37.540')
 ,(44,43,38,NULL,NULL,N'Robichaud, Martin M [NC]','2015-08-20T16:20:08.770',NULL,NULL)
 ,(45,46,28,NULL,'2016-07-07T15:24:33.667',N'Robichaud, Martin M [NC]','2015-08-20T16:23:46.327',N'Robichaud, Martin M [NC]','2016-07-07T15:24:33.667')
 ,(46,49,39,NULL,NULL,N'Robichaud, Martin M [NC]','2016-06-08T09:42:14.570',NULL,NULL)
 ,(47,46,28,NULL,NULL,N'Robichaud, Martin M [NC]','2016-07-07T15:24:33.670',NULL,NULL)
 ,(48,53,28,NULL,'2018-08-21T12:17:21.063',N'Robichaud, Martin M [NC]','2016-07-07T15:33:25.787',N'Dalebozik, Michael MW [NC]','2018-08-21T12:17:21.063')
 ,(49,54,28,NULL,NULL,N'Robichaud, Martin M [NC]','2016-07-07T15:34:33.807',NULL,NULL)
 ,(50,55,28,NULL,'2016-07-07T15:45:44.587',N'Robichaud, Martin M [NC]','2016-07-07T15:45:01.023',N'Robichaud, Martin M [NC]','2016-07-07T15:45:44.587')
 ,(51,55,28,NULL,'2016-07-07T15:47:33.280',N'Robichaud, Martin M [NC]','2016-07-07T15:45:44.593',N'Robichaud, Martin M [NC]','2016-07-07T15:47:33.280')
 ,(52,56,28,NULL,NULL,N'Robichaud, Martin M [NC]','2016-07-07T15:46:58.147',NULL,NULL)
 ,(53,55,28,NULL,NULL,N'Robichaud, Martin M [NC]','2016-07-07T15:47:33.280',NULL,NULL)
 ,(54,57,28,NULL,NULL,N'Robichaud, Martin M [NC]','2016-07-07T15:48:46.063',NULL,NULL)
 ,(55,58,28,NULL,NULL,N'Robichaud, Martin M [NC]','2016-07-07T15:50:18.870',NULL,NULL)
 ,(56,59,28,NULL,NULL,N'Robichaud, Martin M [NC]','2016-07-07T15:51:39.080',NULL,NULL)
 ,(57,60,28,NULL,NULL,N'Robichaud, Martin M [NC]','2016-07-07T15:52:25.653',NULL,NULL)
 ,(58,61,28,NULL,'2018-06-21T15:32:06.377',N'Robichaud, Martin M [NC]','2016-07-07T15:54:23.633',N'Dalebozik, Michael MW [NC]','2018-06-21T15:32:06.377')
 ,(59,62,38,NULL,'2016-09-08T15:42:41.410',N'Robichaud, Martin M [NC]','2016-09-08T10:30:31.293',N'Robichaud, Martin M [NC]','2016-09-08T15:42:41.410')
 ,(60,62,38,NULL,NULL,N'Robichaud, Martin M [NC]','2016-09-08T15:42:41.410',NULL,NULL)
 ,(61,63,28,NULL,'2018-08-21T12:24:37.483',N'Dalebozik, Michael MW [NC]','2018-03-22T09:54:26.587',N'Dalebozik, Michael MW [NC]','2018-08-21T12:24:37.483')
 ,(62,64,28,NULL,'2018-08-10T12:13:39.140',N'Dalebozik, Michael MW [NC]','2018-08-10T12:12:22.350',N'Dalebozik, Michael MW [NC]','2018-08-10T12:13:39.140')
 ,(63,64,28,NULL,'2018-08-21T12:23:57.703',N'Dalebozik, Michael MW [NC]','2018-08-10T12:13:39.143',N'Dalebozik, Michael MW [NC]','2018-08-21T12:23:57.703')
 ,(64,53,28,NULL,'2018-08-21T12:17:24.047',N'Dalebozik, Michael MW [NC]','2018-08-21T12:17:21.063',N'Dalebozik, Michael MW [NC]','2018-08-21T12:17:24.047')
 ,(65,53,28,NULL,'2018-08-21T12:18:10.370',N'Dalebozik, Michael MW [NC]','2018-08-21T12:17:24.053',N'Dalebozik, Michael MW [NC]','2018-08-21T12:18:10.370')
 ,(66,53,28,NULL,NULL,N'Dalebozik, Michael MW [NC]','2018-08-21T12:18:10.373',NULL,NULL)
 ,(67,64,28,NULL,'2018-08-21T12:24:54.547',N'Dalebozik, Michael MW [NC]','2018-08-21T12:23:57.707',N'Dalebozik, Michael MW [NC]','2018-08-21T12:24:54.547')
 ,(68,63,28,NULL,NULL,N'Dalebozik, Michael MW [NC]','2018-08-21T12:24:37.487',NULL,NULL)
 ,(69,64,28,NULL,'2018-11-28T10:40:08.157',N'Dalebozik, Michael MW [NC]','2018-08-21T12:24:54.547',N'Dalebozik, Michael MW [NC]','2018-11-28T10:40:08.157')
 ,(70,65,38,NULL,'2018-11-21T13:50:43.340',N'Dalebozik, Michael MW [NC]','2018-11-21T10:02:04.987',N'Belanger, Joel J [NC]','2018-11-21T13:50:43.340')
 ,(71,65,38,NULL,'2019-01-02T09:19:41.110',N'Belanger, Joel J [NC]','2018-11-21T13:50:43.343',NULL,'2019-01-02T09:19:41.110')
 ,(72,64,28,NULL,'2018-11-28T10:40:42.680',N'Dalebozik, Michael MW [NC]','2018-11-28T10:40:08.160',N'Dalebozik, Michael MW [NC]','2018-11-28T10:40:42.680')
 ,(73,64,28,NULL,NULL,N'Dalebozik, Michael MW [NC]','2018-11-28T10:40:42.683',NULL,NULL)
 ,(76,65,39,NULL,'2019-01-02T10:44:48.653',N'Dalebozik, Michael MW [NC]','2019-01-02T10:43:09.413',N'Dalebozik, Michael MW [NC]','2019-01-02T10:44:48.653')
 ,(77,65,39,NULL,'2019-01-02T10:45:32.543',N'Dalebozik, Michael MW [NC]','2019-01-02T10:44:48.653',N'Dalebozik, Michael MW [NC]','2019-01-02T10:45:32.543')
 ,(78,65,39,NULL,'2019-01-02T10:46:01.460',N'Dalebozik, Michael MW [NC]','2019-01-02T10:45:32.543',N'Dalebozik, Michael MW [NC]','2019-01-02T10:46:01.460')
 ,(79,65,39,NULL,'2019-08-02T15:17:06.407',N'Dalebozik, Michael MW [NC]','2019-01-02T10:46:01.460',N'Robichaud, Martin M [NC]','2019-08-02T15:17:06.407')
 ,(80,66,28,NULL,'2020-03-20T14:05:46.423',N'Dalebozik, Michael MW [NC]','2019-05-03T11:18:10.463',N'Robichaud, Martin M [NC]','2020-03-20T14:05:46.423')
 ,(81,66,38,NULL,'2020-03-20T14:05:46.423',N'Dalebozik, Michael MW [NC]','2019-05-03T11:18:10.467',N'Robichaud, Martin M [NC]','2020-03-20T14:05:46.423')
 ,(82,65,38,NULL,'2019-11-26T10:40:25.820',N'Dalebozik, Michael MW [NC]','2019-11-26T10:31:01.410',N'Dalebozik, Michael MW [NC]','2019-11-26T10:40:25.820')
 ,(83,65,39,NULL,'2019-11-26T10:40:25.820',N'Dalebozik, Michael MW [NC]','2019-11-26T10:31:01.417',N'Dalebozik, Michael MW [NC]','2019-11-26T10:40:25.820')
 ,(84,65,38,NULL,'2020-03-20T14:02:42.057',N'Dalebozik, Michael MW [NC]','2019-11-26T10:40:25.823',NULL,'2020-03-20T14:02:42.057')
 ,(85,65,39,NULL,'2020-03-20T14:02:42.057',N'Dalebozik, Michael MW [NC]','2019-11-26T10:40:25.823',NULL,'2020-03-20T14:02:42.057')
 ,(86,67,28,NULL,NULL,N'Dalebozik, Michael MW [NC]','2020-01-24T08:58:16.380',NULL,NULL)
 ,(87,44,38,NULL,NULL,N'Robichaud, Martin M [NC]','2020-03-20T13:54:27.310',NULL,NULL)
 ,(88,66,28,NULL,NULL,N'Robichaud, Martin M [NC]','2020-03-20T14:06:02.783',NULL,NULL)
 ,(89,66,38,NULL,NULL,N'Robichaud, Martin M [NC]','2020-03-20T14:06:02.783',NULL,NULL)
 ,(90,68,28,NULL,'2022-11-23T00:04:47.330',N'Robichaud, Martin M [NC]','2022-11-10T08:33:01.553',N'Robichaud, Martin M [NC]','2022-11-23T00:04:47.330')
 ,(91,68,28,NULL,'2022-11-27T10:59:37.233',N'Robichaud, Martin M [NC]','2022-11-23T00:04:47.333',N'Robichaud, Martin M [NC]','2022-11-27T10:59:37.233')
 ,(92,68,28,NULL,NULL,N'Robichaud, Martin M [NC]','2022-11-27T10:59:37.233',NULL,NULL)
) AS [Source] ([REQ_STATUS_JUSTIFICATION_ID],[HR_JUSTIFICATION_ID],[REQUEST_STATUS_ID],[EFFECTIVE_DATE],[EXPIRY_DATE],[USER_CREATED],[DATE_CREATED],[USER_UPDATED],[DATE_UPDATED])
ON ([Target].[REQ_STATUS_JUSTIFICATION_ID] = [Source].[REQ_STATUS_JUSTIFICATION_ID])
WHEN MATCHED AND (
	NULLIF([Source].[HR_JUSTIFICATION_ID], [Target].[HR_JUSTIFICATION_ID]) IS NOT NULL OR NULLIF([Target].[HR_JUSTIFICATION_ID], [Source].[HR_JUSTIFICATION_ID]) IS NOT NULL OR 
	NULLIF([Source].[REQUEST_STATUS_ID], [Target].[REQUEST_STATUS_ID]) IS NOT NULL OR NULLIF([Target].[REQUEST_STATUS_ID], [Source].[REQUEST_STATUS_ID]) IS NOT NULL OR 
	NULLIF([Source].[EFFECTIVE_DATE], [Target].[EFFECTIVE_DATE]) IS NOT NULL OR NULLIF([Target].[EFFECTIVE_DATE], [Source].[EFFECTIVE_DATE]) IS NOT NULL OR 
	NULLIF([Source].[EXPIRY_DATE], [Target].[EXPIRY_DATE]) IS NOT NULL OR NULLIF([Target].[EXPIRY_DATE], [Source].[EXPIRY_DATE]) IS NOT NULL OR 
	NULLIF([Source].[USER_CREATED], [Target].[USER_CREATED]) IS NOT NULL OR NULLIF([Target].[USER_CREATED], [Source].[USER_CREATED]) IS NOT NULL OR 
	NULLIF([Source].[DATE_CREATED], [Target].[DATE_CREATED]) IS NOT NULL OR NULLIF([Target].[DATE_CREATED], [Source].[DATE_CREATED]) IS NOT NULL OR 
	NULLIF([Source].[USER_UPDATED], [Target].[USER_UPDATED]) IS NOT NULL OR NULLIF([Target].[USER_UPDATED], [Source].[USER_UPDATED]) IS NOT NULL OR 
	NULLIF([Source].[DATE_UPDATED], [Target].[DATE_UPDATED]) IS NOT NULL OR NULLIF([Target].[DATE_UPDATED], [Source].[DATE_UPDATED]) IS NOT NULL) THEN
 UPDATE SET
  [Target].[HR_JUSTIFICATION_ID] = [Source].[HR_JUSTIFICATION_ID], 
  [Target].[REQUEST_STATUS_ID] = [Source].[REQUEST_STATUS_ID], 
  [Target].[EFFECTIVE_DATE] = [Source].[EFFECTIVE_DATE], 
  [Target].[EXPIRY_DATE] = [Source].[EXPIRY_DATE], 
  [Target].[USER_CREATED] = [Source].[USER_CREATED], 
  [Target].[DATE_CREATED] = [Source].[DATE_CREATED], 
  [Target].[USER_UPDATED] = [Source].[USER_UPDATED], 
  [Target].[DATE_UPDATED] = [Source].[DATE_UPDATED]
WHEN NOT MATCHED BY TARGET THEN
 INSERT([REQ_STATUS_JUSTIFICATION_ID],[HR_JUSTIFICATION_ID],[REQUEST_STATUS_ID],[EFFECTIVE_DATE],[EXPIRY_DATE],[USER_CREATED],[DATE_CREATED],[USER_UPDATED],[DATE_UPDATED])
 VALUES([Source].[REQ_STATUS_JUSTIFICATION_ID],[Source].[HR_JUSTIFICATION_ID],[Source].[REQUEST_STATUS_ID],[Source].[EFFECTIVE_DATE],[Source].[EXPIRY_DATE],[Source].[USER_CREATED],[Source].[DATE_CREATED],[Source].[USER_UPDATED],[Source].[DATE_UPDATED])
WHEN NOT MATCHED BY SOURCE THEN 
 DELETE
OUTPUT $action INTO @mergeOutput462624691;

DECLARE @mergeError462624691 int,
@mergeCount462624691 int,
@mergeCountIns462624691 int,
@mergeCountUpd462624691 int,
@mergeCountDel462624691 int
SELECT @mergeError462624691 = @@ERROR
SELECT @mergeCount462624691 = COUNT(1), @mergeCountIns462624691 = SUM(IIF([DMLAction] = 'INSERT', 1, 0)), @mergeCountUpd462624691 = SUM(IIF([DMLAction] = 'UPDATE', 1, 0)), @mergeCountDel462624691 = SUM (IIF([DMLAction] = 'DELETE', 1, 0)) FROM @mergeOutput462624691
IF @mergeError462624691 != 0
 BEGIN
 PRINT 'ERROR OCCURRED IN MERGE FOR [HRSC].[REQ_STATUS_JUSTIFICATION]. Rows affected: ' + CAST(@mergeCount462624691 AS VARCHAR(100)); -- SQL should always return zero rows affected
 END
ELSE
 BEGIN
 PRINT '[HRSC].[REQ_STATUS_JUSTIFICATION] rows affected by MERGE: ' + CAST(COALESCE(@mergeCount462624691,0) AS VARCHAR(100)) + ' (Inserted: ' + CAST(COALESCE(@mergeCountIns462624691,0) AS VARCHAR(100)) + '; Updated: ' + CAST(COALESCE(@mergeCountUpd462624691,0) AS VARCHAR(100)) + '; Deleted: ' + CAST(COALESCE(@mergeCountDel462624691,0) AS VARCHAR(100)) + ')' ;
 END




SET IDENTITY_INSERT [HRSC].[REQ_STATUS_JUSTIFICATION] OFF
SET NOCOUNT OFF





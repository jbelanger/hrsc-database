
--MERGE generated by 'sp_generate_merge' stored procedure
--Originally by Vyas (http://vyaskn.tripod.com/code): sp_generate_inserts (build 22)
--Adapted for SQL Server 2008+ by Daniel Nolan (https://twitter.com/dnlnln)

SET NOCOUNT ON

SET IDENTITY_INSERT [HRSC].[CD_COI_QUESTION] ON

DECLARE @mergeOutput1786489443 TABLE ( [DMLAction] VARCHAR(6) );
MERGE INTO [HRSC].[CD_COI_QUESTION] AS [Target]
USING (VALUES
  (1,5,N'Q1AL',2,N'What is the nature of your current public service duties within your organization?',N'Quelle est la nature de vos fonctions officielles au sein de la fonction publique fédérale?','2016-11-04T08:03:55.717',NULL,N'System',NULL,'2016-11-04T08:03:55.717',NULL)
 ,(2,5,N'Q2AL',2,N'What is the nature of the asset, liability or trust?',N'Quelle est la nature de vos actifs, passifs?','2016-11-04T08:03:55.717',NULL,N'System',NULL,'2016-11-04T08:03:55.717',NULL)
 ,(3,5,N'Q3AL',2,N'Under what circumstances did you acquire this asset, liability, or trust?',N'Dans quelles circonstances avez-vous acquis ces actifs, ou passifs?','2016-11-04T08:03:55.717',NULL,N'System',NULL,'2016-11-04T08:03:55.717',NULL)
 ,(4,1,N'Q1OEA',2,N'What is the nature of your current public service duties within your organization?',N'Quelle est la nature de vos fonctions officielles au sein de la fonction publique fédérale?','2016-11-04T08:03:55.717',NULL,N'System',NULL,'2016-11-04T08:03:55.717',NULL)
 ,(5,1,N'Q2OEA',2,N'What is the nature of the outside activity?',N'Quelle est la nature de vos activités extérieurs?','2016-11-04T08:03:55.717',NULL,N'System',NULL,'2016-11-04T08:03:55.717',NULL)
 ,(6,1,N'Q3OEA',2,N'What are your responsibilities in your outside employment or activity?',N'Quelles sont vos responsabilités dans vos activités extérieurs?','2016-11-04T08:03:55.717',NULL,N'System',NULL,'2016-11-04T08:03:55.717',NULL)
 ,(7,2,N'Q1PA',2,N'What is the nature of your current public service duties within your organizational context?',N'Quelle est la nature de vos fonctions officielles au sein de la fonction publique fédérale?','2016-11-04T08:03:55.717',NULL,N'System',NULL,'2016-11-04T08:03:55.717',NULL)
 ,(8,2,N'Q2PA',2,N'What is the nature of the political activity?',N'Quelle est la nature de vos activités politiques?','2016-11-04T08:03:55.717',NULL,N'System',NULL,'2016-11-04T08:03:55.717',NULL)
 ,(9,2,N'Q3PA',2,N'What will be your personal visibility during this political activity?',N'Quel sera votre degrés de visibilité au sein de vos activités politiques?','2016-11-04T08:03:55.717',NULL,N'System',NULL,'2016-11-04T08:03:55.717',NULL)
 ,(10,3,N'Q1NPA',2,N'What is the nature of your current public service duties within your organization?',N'Quelle est la nature de vos fonctions officielles au sein de la fonction publique fédérale?','2016-11-04T08:03:55.717',NULL,N'System',NULL,'2016-11-04T08:03:55.717',NULL)
 ,(11,3,N'Q2NPA',2,N'What is the nature of the non-partisan activity in connection with elections?',N'Quelle est la nature de l’activité non-partisane dans le cadre des élections?','2016-11-04T08:03:55.717',NULL,N'System',NULL,'2016-11-04T08:03:55.717',NULL)
 ,(12,3,N'Q3NPA',2,N'What will be your personal visibility during this non-partisan activity in connection with elections?',N'Quel sera votre degrés de visibilité dans le cadre des élections?','2016-11-04T08:03:55.717',NULL,N'System',NULL,'2016-11-04T08:03:55.717',NULL)
 ,(13,4,N'Q1GHO',2,N'What is the value of the gift, hospitality, or other benefit?',N'Quelle est la valeur du don, d''hospitalité ou tout autre avantage?','2016-11-04T08:03:55.717',NULL,N'System',NULL,'2016-11-04T08:03:55.717',NULL)
 ,(14,4,N'Q2GHO',2,N'Under what circumstances did you receive the gift, hospitality or other benefit?',N'Dans quelles circonstances avez-vous reçu le don, l''hospitalité ou tout autre avantage?','2016-11-04T08:03:55.717',NULL,N'System',NULL,'2016-11-04T08:03:55.717',NULL)
 ,(15,4,N'Q3GHO',2,N'What is the nature of the event in which you received the gift, hospitality or other benefit?',N'Quelle est la nature de l''événement dans lequel vous avez reçu le don, d''hospitalité ou tout autre avantage?','2016-11-04T08:03:55.717',NULL,N'System',NULL,'2016-11-04T08:03:55.717',NULL)
 ,(16,8,N'Q1SOC',2,N'What is the nature and purpose of the solicitation?',N'Quelle est la nature et le but de la sollicitation?','2016-11-04T08:03:55.717',NULL,N'System',NULL,'2016-11-04T08:03:55.717',NULL)
 ,(17,9,N'Q1LGC',2,N'What is the nature and purpose of the lottery or game of chance?',N'Quelle est la nature et le but de la loterie ou jeu de hasard?','2016-11-04T08:03:55.717',NULL,N'System',NULL,'2016-11-04T08:03:55.717',NULL)
 ,(18,9,N'Q2LGC',2,N'Have you obtained a provincial license to operate this lottery or game of chance?',N'Avez-vous obtenu une licence provinciale pour opérer cette loterie ou jeu de hasard?','2016-11-04T08:03:55.717',NULL,N'System',NULL,'2016-11-04T08:03:55.717',NULL)
 ,(19,7,N'Q1PT',2,N'Please provide the name of the individual, group of individuals or any other entity that you have a relationship with and specify the nature of the relationship.',N'Veuillez indiquer le nom de l''individu, du groupe d''individus ou de toute autre entité avec lesquels vous avez une relation et préciser la nature de cette relation.','2016-11-04T08:03:55.717',NULL,N'System',NULL,'2016-11-04T08:03:55.717',NULL)
 ,(20,7,N'Q2PT',2,N'Are you involved in a relationship within ESDC where you are directly or indirectly reporting to a family member, friend, or any other person or entity with whom you have a significant relationship?',N'Êtes-vous impliqué dans une relation au sein du ministère ou vous relevez directement ou indirectement d''un membre de votre famille, d''un ami ou de toute autre personne ou entité avec laquelle vous avez une relation importante?','2016-11-04T08:03:55.717',NULL,N'System',NULL,'2016-11-04T08:03:55.717',NULL)
 ,(21,6,N'Q1PE',2,N'What is the nature of your current public service duties within your organization?',N'Quelle est la nature de vos fonctions de service public en cours, au sein de votre organisation?','2016-11-04T08:03:55.717',NULL,N'System',NULL,'2016-11-04T08:03:55.717',NULL)
 ,(22,6,N'Q2PE',2,N'What is the nature of the position you will be accepting after leaving your position with the public service?',N'Quelle est la nature de la position que vous acceptez après avoir quitté votre poste au sein de la fonction publique fédérale?','2016-11-04T08:03:55.717',NULL,N'System',NULL,'2016-11-04T08:03:55.717',NULL)
 ,(23,10,N'Q1DEC',1,N'Description of Assets',N'Description des actifs','2016-11-22T00:00:00',NULL,N'eric.nolet',NULL,'2016-11-22T14:17:42.637',NULL)
 ,(24,10,N'Q2DEC',1,N'Description of Liabilities',N'Description des exigibilités','2016-11-22T00:00:00',NULL,N'eric.nolet',NULL,'2016-11-22T14:18:05.227',NULL)
 ,(25,10,N'Q3DEC',1,N'Description of Outside Activities',N'Description des activités externes','2016-11-22T00:00:00',NULL,N'eric.nolet',NULL,'2016-11-22T14:18:23.973',NULL)
) AS [Source] ([COI_QUESTION_ID],[COI_DECLARATION_TYPE_ID],[COI_QUESTION_TYPE_CODE],[VERSION_ID],[COI_QUESTION_EN],[COI_QUESTION_FR],[EFFECTIVE_DATE],[EXPIRY_DATE],[USER_CREATED],[USER_UPDATED],[DATE_CREATED],[DATE_UPDATED])
ON ([Target].[COI_QUESTION_ID] = [Source].[COI_QUESTION_ID])
WHEN MATCHED AND (
	NULLIF([Source].[COI_DECLARATION_TYPE_ID], [Target].[COI_DECLARATION_TYPE_ID]) IS NOT NULL OR NULLIF([Target].[COI_DECLARATION_TYPE_ID], [Source].[COI_DECLARATION_TYPE_ID]) IS NOT NULL OR 
	NULLIF([Source].[COI_QUESTION_TYPE_CODE], [Target].[COI_QUESTION_TYPE_CODE]) IS NOT NULL OR NULLIF([Target].[COI_QUESTION_TYPE_CODE], [Source].[COI_QUESTION_TYPE_CODE]) IS NOT NULL OR 
	NULLIF([Source].[VERSION_ID], [Target].[VERSION_ID]) IS NOT NULL OR NULLIF([Target].[VERSION_ID], [Source].[VERSION_ID]) IS NOT NULL OR 
	NULLIF([Source].[COI_QUESTION_EN], [Target].[COI_QUESTION_EN]) IS NOT NULL OR NULLIF([Target].[COI_QUESTION_EN], [Source].[COI_QUESTION_EN]) IS NOT NULL OR 
	NULLIF([Source].[COI_QUESTION_FR], [Target].[COI_QUESTION_FR]) IS NOT NULL OR NULLIF([Target].[COI_QUESTION_FR], [Source].[COI_QUESTION_FR]) IS NOT NULL OR 
	NULLIF([Source].[EFFECTIVE_DATE], [Target].[EFFECTIVE_DATE]) IS NOT NULL OR NULLIF([Target].[EFFECTIVE_DATE], [Source].[EFFECTIVE_DATE]) IS NOT NULL OR 
	NULLIF([Source].[EXPIRY_DATE], [Target].[EXPIRY_DATE]) IS NOT NULL OR NULLIF([Target].[EXPIRY_DATE], [Source].[EXPIRY_DATE]) IS NOT NULL OR 
	NULLIF([Source].[USER_CREATED], [Target].[USER_CREATED]) IS NOT NULL OR NULLIF([Target].[USER_CREATED], [Source].[USER_CREATED]) IS NOT NULL OR 
	NULLIF([Source].[USER_UPDATED], [Target].[USER_UPDATED]) IS NOT NULL OR NULLIF([Target].[USER_UPDATED], [Source].[USER_UPDATED]) IS NOT NULL OR 
	NULLIF([Source].[DATE_CREATED], [Target].[DATE_CREATED]) IS NOT NULL OR NULLIF([Target].[DATE_CREATED], [Source].[DATE_CREATED]) IS NOT NULL OR 
	NULLIF([Source].[DATE_UPDATED], [Target].[DATE_UPDATED]) IS NOT NULL OR NULLIF([Target].[DATE_UPDATED], [Source].[DATE_UPDATED]) IS NOT NULL) THEN
 UPDATE SET
  [Target].[COI_DECLARATION_TYPE_ID] = [Source].[COI_DECLARATION_TYPE_ID], 
  [Target].[COI_QUESTION_TYPE_CODE] = [Source].[COI_QUESTION_TYPE_CODE], 
  [Target].[VERSION_ID] = [Source].[VERSION_ID], 
  [Target].[COI_QUESTION_EN] = [Source].[COI_QUESTION_EN], 
  [Target].[COI_QUESTION_FR] = [Source].[COI_QUESTION_FR], 
  [Target].[EFFECTIVE_DATE] = [Source].[EFFECTIVE_DATE], 
  [Target].[EXPIRY_DATE] = [Source].[EXPIRY_DATE], 
  [Target].[USER_CREATED] = [Source].[USER_CREATED], 
  [Target].[USER_UPDATED] = [Source].[USER_UPDATED], 
  [Target].[DATE_CREATED] = [Source].[DATE_CREATED], 
  [Target].[DATE_UPDATED] = [Source].[DATE_UPDATED]
WHEN NOT MATCHED BY TARGET THEN
 INSERT([COI_QUESTION_ID],[COI_DECLARATION_TYPE_ID],[COI_QUESTION_TYPE_CODE],[VERSION_ID],[COI_QUESTION_EN],[COI_QUESTION_FR],[EFFECTIVE_DATE],[EXPIRY_DATE],[USER_CREATED],[USER_UPDATED],[DATE_CREATED],[DATE_UPDATED])
 VALUES([Source].[COI_QUESTION_ID],[Source].[COI_DECLARATION_TYPE_ID],[Source].[COI_QUESTION_TYPE_CODE],[Source].[VERSION_ID],[Source].[COI_QUESTION_EN],[Source].[COI_QUESTION_FR],[Source].[EFFECTIVE_DATE],[Source].[EXPIRY_DATE],[Source].[USER_CREATED],[Source].[USER_UPDATED],[Source].[DATE_CREATED],[Source].[DATE_UPDATED])
OUTPUT $action INTO @mergeOutput1786489443;

DECLARE @mergeError1786489443 int,
@mergeCount1786489443 int,
@mergeCountIns1786489443 int,
@mergeCountUpd1786489443 int,
@mergeCountDel1786489443 int
SELECT @mergeError1786489443 = @@ERROR
SELECT @mergeCount1786489443 = COUNT(1), @mergeCountIns1786489443 = SUM(IIF([DMLAction] = 'INSERT', 1, 0)), @mergeCountUpd1786489443 = SUM(IIF([DMLAction] = 'UPDATE', 1, 0)), @mergeCountDel1786489443 = SUM (IIF([DMLAction] = 'DELETE', 1, 0)) FROM @mergeOutput1786489443
IF @mergeError1786489443 != 0
 BEGIN
 PRINT 'ERROR OCCURRED IN MERGE FOR [HRSC].[CD_COI_QUESTION]. Rows affected: ' + CAST(@mergeCount1786489443 AS VARCHAR(100)); -- SQL should always return zero rows affected
 END
ELSE
 BEGIN
 PRINT '[HRSC].[CD_COI_QUESTION] rows affected by MERGE: ' + CAST(COALESCE(@mergeCount1786489443,0) AS VARCHAR(100)) + ' (Inserted: ' + CAST(COALESCE(@mergeCountIns1786489443,0) AS VARCHAR(100)) + '; Updated: ' + CAST(COALESCE(@mergeCountUpd1786489443,0) AS VARCHAR(100)) + '; Deleted: ' + CAST(COALESCE(@mergeCountDel1786489443,0) AS VARCHAR(100)) + ')' ;
 END




SET IDENTITY_INSERT [HRSC].[CD_COI_QUESTION] OFF
SET NOCOUNT OFF




